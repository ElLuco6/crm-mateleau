<div class="max-w-7xl mx-auto p-6 bg-white rounded-xl shadow-xl">
  <h2 class="text-3xl font-bold text-center text-blue-700 mb-8">Cr√©ation des palanqu√©es</h2>
  <p class="text-sm text-gray-600">
    Capacit√© utilis√©e : {{ getCurrentTeamSize() }} / {{ boatLimit }}
  </p>

  <!-- üöó Conducteur -->
  <div class="w-full mb-10">
    <h3 class="text-xl font-semibold text-gray-700 mb-4 text-center">Conducteur du bateau</h3>

    <p class="text-sm text-gray-600 mb-2 text-center">
      Cliquez sur un moniteur pour l‚Äôassigner comme conducteur.
    </p>

    <div class="flex flex-wrap gap-3 justify-center">
      @for (moniteur of getAvailableDrivers(); track moniteur._id) {
      <div
        class="w-44 bg-white border hover:border-blue-500 hover:bg-blue-50 rounded-lg p-2 shadow-sm cursor-pointer transition text-center"
        [ngClass]="{
          'border-green-500 ring-2 ring-green-300': selectedDriver?._id === moniteur._id
        }" (click)="setDriver(moniteur)">

        <div class="font-semibold text-gray-800 truncate">{{ moniteur.name }}</div>
        <div class="text-xs text-gray-600">Niveau : {{ moniteur.divingLvl }}</div>
        @if (selectedDriver?._id === moniteur._id) {
        <div class="mt-1 text-green-600 text-xs font-medium">‚úîÔ∏è Assign√©</div>
        }
      </div>
      }
    </div>

    @if (selectedDriver) {
    <div class="mt-4 text-center text-green-700 text-sm font-medium">
      Conducteur actuel : {{ selectedDriver.name }}
    </div>
    }
  </div>





  <div class="flex flex-col md:flex-row gap-6">

    <!-- Moniteurs -->
    <div class="w-full md:w-1/3">
      <h3 class="text-xl font-semibold text-gray-700 mb-4 text-center">Moniteurs</h3>
      <div class="flex flex-col gap-4">
        @for (moniteur of moniteurs; track $index) {
        <div class="bg-blue-50 p-4 rounded-lg shadow hover:bg-blue-100 transition">
          <h4 class="font-bold text-blue-800">{{ moniteur.name }}</h4>
          <p class="text-sm text-gray-600">Niveau : {{ moniteur.divingLvl }}</p>
          <button class="mt-2 w-full bg-blue-600 hover:bg-blue-700 text-white py-1 px-3 rounded"
            (click)="AddOnSelectedTeam(undefined, moniteur)">
            S√©lectionner
          </button>
        </div>
        }
      </div>
    </div>

    <!-- √âquipes -->
    <div class="w-full md:w-1/3">
      <h3 class="text-xl font-semibold text-gray-700 mb-4 text-center">√âquipes</h3>
      <div class="flex flex-col gap-4">
        @for (team of teams; track $index) {
        <div
          class="relative p-4 rounded-lg shadow hover:bg-gray-100 transition bg-white border p-5 rounded-2xl shadow-md hover:shadow-lg transition cursor-pointer group"
          [ngClass]="{ 'border-blue-600 ring-2 ring-blue-300': selectedTeam === $index }" (click)="selectTeam($index)">

          <!-- ‚ùå Bouton de suppression -->
          <button (click)="removeTeam($index); $event.stopPropagation()"
            class="absolute top-3 right-3 bg-red-100 text-red-700 hover:bg-red-200 rounded-full w-7 h-7 flex items-center justify-center shadow-sm transition"
            title="Supprimer cette √©quipe">
            ‚úñ
          </button>

          <!-- Titre √©quipe -->
          <h4 class="text-xl font-bold text-gray-800 mb-3 group-hover:text-blue-700 transition">
            √âquipe {{ $index + 1 }}
          </h4>

          <!-- Moniteur -->
          <div class="mb-4">
            @if (team.moniteur) {
            <div class="flex items-center justify-between bg-green-50 p-3 rounded-md">
              <p class="text-green-800 font-medium flex items-center gap-2">
                {{ team.moniteur.name }}
              </p>
              <button class="text-sm text-white-600 hover:underline hover:text-white-800"
                (click)="removeFromSelectedTeam(undefined, team.moniteur, $index); $event.stopPropagation()">
                Retirer
              </button>
            </div>
            } @else {
            <p class="text-white-600 font-medium italic"> Aucun moniteur assign√©</p>
            }
          </div>

          <!-- Membres -->
          <div>
            <p class="text-gray-700 font-semibold mb-2"> Membres :</p>
            <ul class="space-y-2">
              @for (member of team.members; track $index) {
              <li class="flex justify-between items-center bg-gray-50 p-2 rounded-md">
                <span class="text-sm text-gray-700">
                  {{ member.firstName }} ‚Äì {{ member.divingLvl }}
                </span>
                <button class="text-sm text-white-500 hover:text-white-700 hover:underline"
                  (click)="removeFromSelectedTeam(member); $event.stopPropagation()">
                  Retirer
                </button>
              </li>
              }
            </ul>
          </div>

        </div>
        }

        <button class="bg-green-500 hover:bg-green-600 text-white py-2 mt-2 rounded font-semibold" (click)="addTeam()">
          ‚ûï Ajouter une √©quipe
        </button>
      </div>
    </div>

    <!-- Plongeurs -->
    <div class="w-full md:w-1/3">
      <h3 class="text-xl font-semibold text-gray-700 mb-4 text-center">Plongeurs</h3>
      <div class="flex flex-col gap-4">
        @for (diver of divers; track $index) {
        <div class="bg-gray-50 p-4 rounded-lg shadow hover:bg-gray-100 transition">
          <h4 class="font-bold text-gray-800">{{ diver.firstName }} {{ diver.lastName }}</h4>
          <p class="text-sm text-gray-600">Niveau : {{ diver.divingLvl }}</p>
          <button class="mt-2 w-full bg-gray-800 hover:bg-gray-900 text-white py-1 px-3 rounded"
            (click)="AddOnSelectedTeam(diver)">
            S√©lectionner
          </button>
        </div>
        }
      </div>
    </div>
  </div>
</div>
{{this.teams | json}}